//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <assert.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

// ------------------- Function Prototypes --------------------

int32_t new_file(struct _IO_FILE * file_path, int32_t str);
int32_t out(int32_t a1, int32_t a2);
int32_t partial_write(int32_t a1, int32_t a2);
int32_t read_file(struct _IO_FILE * file_path);
int32_t read_note(void);
int32_t service_example(void);
int32_t string_out(char * str);
int32_t write_note(void);

// --------------------- Global Variables ---------------------

struct _IO_FILE * g1 = NULL; // 0x804a2c0
struct _IO_FILE * g2 = NULL; // 0x804a2e0

// ------------------------ Functions -------------------------

// Address range: 0x80487bd - 0x8048856
int32_t partial_write(int32_t a1, int32_t a2) {
    int32_t nbyte = a2;
    int32_t v1 = a1;
    if (a2 <= 0) {
        // 0x80487ca
        __assert_fail("len <= 2147483647L", "utils.h", 32, "partial_write");
        nbyte = a2;
        v1 = a1;
        // branch -> 0x80487f4
    }
  lab_0x80487f4_25:
    while (true) {
        char * buf = (char *)v1;
        // branch -> 0x80487f4
        while (true) {
            int32_t v2 = write(1, buf, nbyte); // 0x8048809
            int32_t v3 = v2; // 0x804880919
            int32_t v4; // 0x8048842
            int32_t v5; // 0x804884b10
            switch (v2) {
                case 4: {
                    while (true) {
                        // 0x80487f4
                        v2 = write(1, buf, nbyte);
                        v3 = v2;
                        switch (v2) {
                            case 4: {
                                while (true) {
                                    // 0x80487f4
                                    v2 = write(1, buf, nbyte);
                                    v3 = v2;
                                    switch (v2) {
                                        case 4: {
                                            while (true) {
                                                // 0x80487f4
                                                v2 = write(1, buf, nbyte);
                                                v3 = v2;
                                                switch (v2) {
                                                    case 4: {
                                                        while (true) {
                                                            // 0x80487f4
                                                            v2 = write(1, buf, nbyte);
                                                            v3 = v2;
                                                            switch (v2) {
                                                                case 4: {
                                                                    while (true) {
                                                                        // 0x80487f4
                                                                        v2 = write(1, buf, nbyte);
                                                                        v3 = v2;
                                                                        switch (v2) {
                                                                            case 4: {
                                                                                while (true) {
                                                                                    // 0x80487f4
                                                                                    v2 = write(1, buf, nbyte);
                                                                                    v3 = v2;
                                                                                    switch (v2) {
                                                                                        case 4: {
                                                                                            while (true) {
                                                                                                // 0x80487f4
                                                                                                v2 = write(1, buf, nbyte);
                                                                                                v3 = v2;
                                                                                                switch (v2) {
                                                                                                    case 4: {
                                                                                                        while (true) {
                                                                                                            // 0x80487f4
                                                                                                            v2 = write(1, buf, nbyte);
                                                                                                            v3 = v2;
                                                                                                            switch (v2) {
                                                                                                                case 4: {
                                                                                                                    while (true) {
                                                                                                                        // 0x80487f4
                                                                                                                        v2 = write(1, buf, nbyte);
                                                                                                                        v3 = v2;
                                                                                                                        switch (v2) {
                                                                                                                            case 4: {
                                                                                                                                while (true) {
                                                                                                                                    // 0x80487f4
                                                                                                                                    v2 = write(1, buf, nbyte);
                                                                                                                                    v3 = v2;
                                                                                                                                    switch (v2) {
                                                                                                                                        case 4: {
                                                                                                                                            while (true) {
                                                                                                                                                // 0x80487f4
                                                                                                                                                v2 = write(1, buf, nbyte);
                                                                                                                                                v3 = v2;
                                                                                                                                                switch (v2) {
                                                                                                                                                    case 4: {
                                                                                                                                                        while (true) {
                                                                                                                                                            // 0x80487f4
                                                                                                                                                            v2 = write(1, buf, nbyte);
                                                                                                                                                            v3 = v2;
                                                                                                                                                            switch (v2) {
                                                                                                                                                                case 4: {
                                                                                                                                                                    while (true) {
                                                                                                                                                                        // 0x80487f4
                                                                                                                                                                        v2 = write(1, buf, nbyte);
                                                                                                                                                                        v3 = v2;
                                                                                                                                                                        switch (v2) {
                                                                                                                                                                            case 4: {
                                                                                                                                                                                while (true) {
                                                                                                                                                                                    // 0x80487f4
                                                                                                                                                                                    v2 = write(1, buf, nbyte);
                                                                                                                                                                                    v3 = v2;
                                                                                                                                                                                    switch (v2) {
                                                                                                                                                                                        case 4: {
                                                                                                                                                                                            while (true) {
                                                                                                                                                                                                // 0x80487f4
                                                                                                                                                                                                v2 = write(1, buf, nbyte);
                                                                                                                                                                                                v3 = v2;
                                                                                                                                                                                                switch (v2) {
                                                                                                                                                                                                    case 4: {
                                                                                                                                                                                                        while (true) {
                                                                                                                                                                                                            // 0x80487f4
                                                                                                                                                                                                            v2 = write(1, buf, nbyte);
                                                                                                                                                                                                            v3 = v2;
                                                                                                                                                                                                            switch (v2) {
                                                                                                                                                                                                                case 4: {
                                                                                                                                                                                                                    while (true) {
                                                                                                                                                                                                                        // 0x80487f4
                                                                                                                                                                                                                        v2 = write(1, buf, nbyte);
                                                                                                                                                                                                                        v3 = v2;
                                                                                                                                                                                                                        switch (v2) {
                                                                                                                                                                                                                            case 4: {
                                                                                                                                                                                                                                while (true) {
                                                                                                                                                                                                                                    // 0x80487f4
                                                                                                                                                                                                                                    v2 = write(1, buf, nbyte);
                                                                                                                                                                                                                                    v3 = v2;
                                                                                                                                                                                                                                    switch (v2) {
                                                                                                                                                                                                                                        case 4: {
                                                                                                                                                                                                                                            while (true) {
                                                                                                                                                                                                                                                // 0x80487f4
                                                                                                                                                                                                                                                v2 = write(1, buf, nbyte);
                                                                                                                                                                                                                                                v3 = v2;
                                                                                                                                                                                                                                                switch (v2) {
                                                                                                                                                                                                                                                    case 4: {
                                                                                                                                                                                                                                                        while (true) {
                                                                                                                                                                                                                                                            // 0x80487f4
                                                                                                                                                                                                                                                            v2 = write(1, buf, nbyte);
                                                                                                                                                                                                                                                            v3 = v2;
                                                                                                                                                                                                                                                            switch (v2) {
                                                                                                                                                                                                                                                                case 4: {
                                                                                                                                                                                                                                                                    while (true) {
                                                                                                                                                                                                                                                                        // 0x80487f4
                                                                                                                                                                                                                                                                        v2 = write(1, buf, nbyte);
                                                                                                                                                                                                                                                                        v3 = v2;
                                                                                                                                                                                                                                                                        switch (v2) {
                                                                                                                                                                                                                                                                            case 4: {
                                                                                                                                                                                                                                                                                while (true) {
                                                                                                                                                                                                                                                                                    // 0x80487f4
                                                                                                                                                                                                                                                                                    v2 = write(1, buf, nbyte);
                                                                                                                                                                                                                                                                                    v3 = v2;
                                                                                                                                                                                                                                                                                    switch (v2) {
                                                                                                                                                                                                                                                                                        case 4: {
                                                                                                                                                                                                                                                                                            while (true) {
                                                                                                                                                                                                                                                                                                // 0x80487f4
                                                                                                                                                                                                                                                                                                v2 = write(1, buf, nbyte);
                                                                                                                                                                                                                                                                                                v3 = v2;
                                                                                                                                                                                                                                                                                                switch (v2) {
                                                                                                                                                                                                                                                                                                    case 4: {
                                                                                                                                                                                                                                                                                                        while (true) {
                                                                                                                                                                                                                                                                                                            // 0x80487f4
                                                                                                                                                                                                                                                                                                            v2 = write(1, buf, nbyte);
                                                                                                                                                                                                                                                                                                            v3 = v2;
                                                                                                                                                                                                                                                                                                            switch (v2) {
                                                                                                                                                                                                                                                                                                                case 4: {
                                                                                                                                                                                                                                                                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                                                                                                                                                                                                                                                    break;
                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                case -1: {
                                                                                                                                                                                                                                                                                                                    // 0x804881d
                                                                                                                                                                                                                                                                                                                    err(120, "Write error!");
                                                                                                                                                                                                                                                                                                                    // branch -> 0x8048839
                                                                                                                                                                                                                                                                                                                    v3 = -1;
                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                default: {
                                                                                                                                                                                                                                                                                                                    // 0x8048839
                                                                                                                                                                                                                                                                                                                    v4 = v3 + v1;
                                                                                                                                                                                                                                                                                                                    if (nbyte == v3) {
                                                                                                                                                                                                                                                                                                                        v5 = v4;
                                                                                                                                                                                                                                                                                                                        // break (via goto) -> 0x804884b
                                                                                                                                                                                                                                                                                                                        goto lab_0x804884b_25;
                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                    nbyte -= v3;
                                                                                                                                                                                                                                                                                                                    v1 = v4;
                                                                                                                                                                                                                                                                                                                    // continue (via goto) -> 0x80487f4
                                                                                                                                                                                                                                                                                                                    goto lab_0x80487f4_25;
                                                                                                                                                                                                                                                                                                                    break;
                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                case 0: {
                                                                                                                                                                                                                                                                                                                    // 0x804884b
                                                                                                                                                                                                                                                                                                                    return v1 - a1;
                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                        // 0x804884b
                                                                                                                                                                                                                                                                                                        return v5 - a1;
                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                    case -1: {
                                                                                                                                                                                                                                                                                                        // 0x804881d
                                                                                                                                                                                                                                                                                                        err(120, "Write error!");
                                                                                                                                                                                                                                                                                                        // branch -> 0x8048839
                                                                                                                                                                                                                                                                                                        v3 = -1;
                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                    default: {
                                                                                                                                                                                                                                                                                                        // 0x8048839
                                                                                                                                                                                                                                                                                                        v4 = v3 + v1;
                                                                                                                                                                                                                                                                                                        if (nbyte == v3) {
                                                                                                                                                                                                                                                                                                            v5 = v4;
                                                                                                                                                                                                                                                                                                            // break (via goto) -> 0x804884b
                                                                                                                                                                                                                                                                                                            goto lab_0x804884b_25;
                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                        nbyte -= v3;
                                                                                                                                                                                                                                                                                                        v1 = v4;
                                                                                                                                                                                                                                                                                                        // continue (via goto) -> 0x80487f4
                                                                                                                                                                                                                                                                                                        goto lab_0x80487f4_25;
                                                                                                                                                                                                                                                                                                        break;
                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                    case 0: {
                                                                                                                                                                                                                                                                                                        // 0x804884b
                                                                                                                                                                                                                                                                                                        return v1 - a1;
                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            // 0x804884b
                                                                                                                                                                                                                                                                                            return v5 - a1;
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        case -1: {
                                                                                                                                                                                                                                                                                            // 0x804881d
                                                                                                                                                                                                                                                                                            err(120, "Write error!");
                                                                                                                                                                                                                                                                                            // branch -> 0x8048839
                                                                                                                                                                                                                                                                                            v3 = -1;
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        default: {
                                                                                                                                                                                                                                                                                            // 0x8048839
                                                                                                                                                                                                                                                                                            v4 = v3 + v1;
                                                                                                                                                                                                                                                                                            if (nbyte == v3) {
                                                                                                                                                                                                                                                                                                v5 = v4;
                                                                                                                                                                                                                                                                                                // break (via goto) -> 0x804884b
                                                                                                                                                                                                                                                                                                goto lab_0x804884b_25;
                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                            nbyte -= v3;
                                                                                                                                                                                                                                                                                            v1 = v4;
                                                                                                                                                                                                                                                                                            // continue (via goto) -> 0x80487f4
                                                                                                                                                                                                                                                                                            goto lab_0x80487f4_25;
                                                                                                                                                                                                                                                                                            break;
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                        case 0: {
                                                                                                                                                                                                                                                                                            // 0x804884b
                                                                                                                                                                                                                                                                                            return v1 - a1;
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                // 0x804884b
                                                                                                                                                                                                                                                                                return v5 - a1;
                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                            case -1: {
                                                                                                                                                                                                                                                                                // 0x804881d
                                                                                                                                                                                                                                                                                err(120, "Write error!");
                                                                                                                                                                                                                                                                                // branch -> 0x8048839
                                                                                                                                                                                                                                                                                v3 = -1;
                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                            default: {
                                                                                                                                                                                                                                                                                // 0x8048839
                                                                                                                                                                                                                                                                                v4 = v3 + v1;
                                                                                                                                                                                                                                                                                if (nbyte == v3) {
                                                                                                                                                                                                                                                                                    v5 = v4;
                                                                                                                                                                                                                                                                                    // break (via goto) -> 0x804884b
                                                                                                                                                                                                                                                                                    goto lab_0x804884b_25;
                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                nbyte -= v3;
                                                                                                                                                                                                                                                                                v1 = v4;
                                                                                                                                                                                                                                                                                // continue (via goto) -> 0x80487f4
                                                                                                                                                                                                                                                                                goto lab_0x80487f4_25;
                                                                                                                                                                                                                                                                                break;
                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                            case 0: {
                                                                                                                                                                                                                                                                                // 0x804884b
                                                                                                                                                                                                                                                                                return v1 - a1;
                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                    // 0x804884b
                                                                                                                                                                                                                                                                    return v5 - a1;
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                case -1: {
                                                                                                                                                                                                                                                                    // 0x804881d
                                                                                                                                                                                                                                                                    err(120, "Write error!");
                                                                                                                                                                                                                                                                    // branch -> 0x8048839
                                                                                                                                                                                                                                                                    v3 = -1;
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                default: {
                                                                                                                                                                                                                                                                    // 0x8048839
                                                                                                                                                                                                                                                                    v4 = v3 + v1;
                                                                                                                                                                                                                                                                    if (nbyte == v3) {
                                                                                                                                                                                                                                                                        v5 = v4;
                                                                                                                                                                                                                                                                        // break (via goto) -> 0x804884b
                                                                                                                                                                                                                                                                        goto lab_0x804884b_25;
                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                    nbyte -= v3;
                                                                                                                                                                                                                                                                    v1 = v4;
                                                                                                                                                                                                                                                                    // continue (via goto) -> 0x80487f4
                                                                                                                                                                                                                                                                    goto lab_0x80487f4_25;
                                                                                                                                                                                                                                                                    break;
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                case 0: {
                                                                                                                                                                                                                                                                    // 0x804884b
                                                                                                                                                                                                                                                                    return v1 - a1;
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                        // 0x804884b
                                                                                                                                                                                                                                                        return v5 - a1;
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                    case -1: {
                                                                                                                                                                                                                                                        // 0x804881d
                                                                                                                                                                                                                                                        err(120, "Write error!");
                                                                                                                                                                                                                                                        // branch -> 0x8048839
                                                                                                                                                                                                                                                        v3 = -1;
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                    default: {
                                                                                                                                                                                                                                                        // 0x8048839
                                                                                                                                                                                                                                                        v4 = v3 + v1;
                                                                                                                                                                                                                                                        if (nbyte == v3) {
                                                                                                                                                                                                                                                            v5 = v4;
                                                                                                                                                                                                                                                            // break (via goto) -> 0x804884b
                                                                                                                                                                                                                                                            goto lab_0x804884b_25;
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                        nbyte -= v3;
                                                                                                                                                                                                                                                        v1 = v4;
                                                                                                                                                                                                                                                        // continue (via goto) -> 0x80487f4
                                                                                                                                                                                                                                                        goto lab_0x80487f4_25;
                                                                                                                                                                                                                                                        break;
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                    case 0: {
                                                                                                                                                                                                                                                        // 0x804884b
                                                                                                                                                                                                                                                        return v1 - a1;
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                            // 0x804884b
                                                                                                                                                                                                                                            return v5 - a1;
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                        case -1: {
                                                                                                                                                                                                                                            // 0x804881d
                                                                                                                                                                                                                                            err(120, "Write error!");
                                                                                                                                                                                                                                            // branch -> 0x8048839
                                                                                                                                                                                                                                            v3 = -1;
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                        default: {
                                                                                                                                                                                                                                            // 0x8048839
                                                                                                                                                                                                                                            v4 = v3 + v1;
                                                                                                                                                                                                                                            if (nbyte == v3) {
                                                                                                                                                                                                                                                v5 = v4;
                                                                                                                                                                                                                                                // break (via goto) -> 0x804884b
                                                                                                                                                                                                                                                goto lab_0x804884b_25;
                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                            nbyte -= v3;
                                                                                                                                                                                                                                            v1 = v4;
                                                                                                                                                                                                                                            // continue (via goto) -> 0x80487f4
                                                                                                                                                                                                                                            goto lab_0x80487f4_25;
                                                                                                                                                                                                                                            break;
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                        case 0: {
                                                                                                                                                                                                                                            // 0x804884b
                                                                                                                                                                                                                                            return v1 - a1;
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                // 0x804884b
                                                                                                                                                                                                                                return v5 - a1;
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                            case -1: {
                                                                                                                                                                                                                                // 0x804881d
                                                                                                                                                                                                                                err(120, "Write error!");
                                                                                                                                                                                                                                // branch -> 0x8048839
                                                                                                                                                                                                                                v3 = -1;
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                            default: {
                                                                                                                                                                                                                                // 0x8048839
                                                                                                                                                                                                                                v4 = v3 + v1;
                                                                                                                                                                                                                                if (nbyte == v3) {
                                                                                                                                                                                                                                    v5 = v4;
                                                                                                                                                                                                                                    // break (via goto) -> 0x804884b
                                                                                                                                                                                                                                    goto lab_0x804884b_25;
                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                nbyte -= v3;
                                                                                                                                                                                                                                v1 = v4;
                                                                                                                                                                                                                                // continue (via goto) -> 0x80487f4
                                                                                                                                                                                                                                goto lab_0x80487f4_25;
                                                                                                                                                                                                                                break;
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                            case 0: {
                                                                                                                                                                                                                                // 0x804884b
                                                                                                                                                                                                                                return v1 - a1;
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                    // 0x804884b
                                                                                                                                                                                                                    return v5 - a1;
                                                                                                                                                                                                                }
                                                                                                                                                                                                                case -1: {
                                                                                                                                                                                                                    // 0x804881d
                                                                                                                                                                                                                    err(120, "Write error!");
                                                                                                                                                                                                                    // branch -> 0x8048839
                                                                                                                                                                                                                    v3 = -1;
                                                                                                                                                                                                                }
                                                                                                                                                                                                                default: {
                                                                                                                                                                                                                    // 0x8048839
                                                                                                                                                                                                                    v4 = v3 + v1;
                                                                                                                                                                                                                    if (nbyte == v3) {
                                                                                                                                                                                                                        v5 = v4;
                                                                                                                                                                                                                        // break (via goto) -> 0x804884b
                                                                                                                                                                                                                        goto lab_0x804884b_25;
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                    nbyte -= v3;
                                                                                                                                                                                                                    v1 = v4;
                                                                                                                                                                                                                    // continue (via goto) -> 0x80487f4
                                                                                                                                                                                                                    goto lab_0x80487f4_25;
                                                                                                                                                                                                                    break;
                                                                                                                                                                                                                }
                                                                                                                                                                                                                case 0: {
                                                                                                                                                                                                                    // 0x804884b
                                                                                                                                                                                                                    return v1 - a1;
                                                                                                                                                                                                                }
                                                                                                                                                                                                            }
                                                                                                                                                                                                        }
                                                                                                                                                                                                        // 0x804884b
                                                                                                                                                                                                        return v5 - a1;
                                                                                                                                                                                                    }
                                                                                                                                                                                                    case -1: {
                                                                                                                                                                                                        // 0x804881d
                                                                                                                                                                                                        err(120, "Write error!");
                                                                                                                                                                                                        // branch -> 0x8048839
                                                                                                                                                                                                        v3 = -1;
                                                                                                                                                                                                    }
                                                                                                                                                                                                    default: {
                                                                                                                                                                                                        // 0x8048839
                                                                                                                                                                                                        v4 = v3 + v1;
                                                                                                                                                                                                        if (nbyte == v3) {
                                                                                                                                                                                                            v5 = v4;
                                                                                                                                                                                                            // break (via goto) -> 0x804884b
                                                                                                                                                                                                            goto lab_0x804884b_25;
                                                                                                                                                                                                        }
                                                                                                                                                                                                        nbyte -= v3;
                                                                                                                                                                                                        v1 = v4;
                                                                                                                                                                                                        // continue (via goto) -> 0x80487f4
                                                                                                                                                                                                        goto lab_0x80487f4_25;
                                                                                                                                                                                                        break;
                                                                                                                                                                                                    }
                                                                                                                                                                                                    case 0: {
                                                                                                                                                                                                        // 0x804884b
                                                                                                                                                                                                        return v1 - a1;
                                                                                                                                                                                                    }
                                                                                                                                                                                                }
                                                                                                                                                                                            }
                                                                                                                                                                                            // 0x804884b
                                                                                                                                                                                            return v5 - a1;
                                                                                                                                                                                        }
                                                                                                                                                                                        case -1: {
                                                                                                                                                                                            // 0x804881d
                                                                                                                                                                                            err(120, "Write error!");
                                                                                                                                                                                            // branch -> 0x8048839
                                                                                                                                                                                            v3 = -1;
                                                                                                                                                                                        }
                                                                                                                                                                                        default: {
                                                                                                                                                                                            // 0x8048839
                                                                                                                                                                                            v4 = v3 + v1;
                                                                                                                                                                                            if (nbyte == v3) {
                                                                                                                                                                                                v5 = v4;
                                                                                                                                                                                                // break (via goto) -> 0x804884b
                                                                                                                                                                                                goto lab_0x804884b_25;
                                                                                                                                                                                            }
                                                                                                                                                                                            nbyte -= v3;
                                                                                                                                                                                            v1 = v4;
                                                                                                                                                                                            // continue (via goto) -> 0x80487f4
                                                                                                                                                                                            goto lab_0x80487f4_25;
                                                                                                                                                                                            break;
                                                                                                                                                                                        }
                                                                                                                                                                                        case 0: {
                                                                                                                                                                                            // 0x804884b
                                                                                                                                                                                            return v1 - a1;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                // 0x804884b
                                                                                                                                                                                return v5 - a1;
                                                                                                                                                                            }
                                                                                                                                                                            case -1: {
                                                                                                                                                                                // 0x804881d
                                                                                                                                                                                err(120, "Write error!");
                                                                                                                                                                                // branch -> 0x8048839
                                                                                                                                                                                v3 = -1;
                                                                                                                                                                            }
                                                                                                                                                                            default: {
                                                                                                                                                                                // 0x8048839
                                                                                                                                                                                v4 = v3 + v1;
                                                                                                                                                                                if (nbyte == v3) {
                                                                                                                                                                                    v5 = v4;
                                                                                                                                                                                    // break (via goto) -> 0x804884b
                                                                                                                                                                                    goto lab_0x804884b_25;
                                                                                                                                                                                }
                                                                                                                                                                                nbyte -= v3;
                                                                                                                                                                                v1 = v4;
                                                                                                                                                                                // continue (via goto) -> 0x80487f4
                                                                                                                                                                                goto lab_0x80487f4_25;
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            case 0: {
                                                                                                                                                                                // 0x804884b
                                                                                                                                                                                return v1 - a1;
                                                                                                                                                                            }
                                                                                                                                                                        }
                                                                                                                                                                    }
                                                                                                                                                                    // 0x804884b
                                                                                                                                                                    return v5 - a1;
                                                                                                                                                                }
                                                                                                                                                                case -1: {
                                                                                                                                                                    // 0x804881d
                                                                                                                                                                    err(120, "Write error!");
                                                                                                                                                                    // branch -> 0x8048839
                                                                                                                                                                    v3 = -1;
                                                                                                                                                                }
                                                                                                                                                                default: {
                                                                                                                                                                    // 0x8048839
                                                                                                                                                                    v4 = v3 + v1;
                                                                                                                                                                    if (nbyte == v3) {
                                                                                                                                                                        v5 = v4;
                                                                                                                                                                        // break (via goto) -> 0x804884b
                                                                                                                                                                        goto lab_0x804884b_25;
                                                                                                                                                                    }
                                                                                                                                                                    nbyte -= v3;
                                                                                                                                                                    v1 = v4;
                                                                                                                                                                    // continue (via goto) -> 0x80487f4
                                                                                                                                                                    goto lab_0x80487f4_25;
                                                                                                                                                                    break;
                                                                                                                                                                }
                                                                                                                                                                case 0: {
                                                                                                                                                                    v5 = v1;
                                                                                                                                                                  lab_0x804884b_25:
                                                                                                                                                                    // 0x804884b
                                                                                                                                                                    return v5 - a1;
                                                                                                                                                                }
                                                                                                                                                            }
                                                                                                                                                        }
                                                                                                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                                                                                        break;
                                                                                                                                                    }
                                                                                                                                                    case -1: {
                                                                                                                                                        // 0x804881d
                                                                                                                                                        err(120, "Write error!");
                                                                                                                                                        // branch -> 0x8048839
                                                                                                                                                        v3 = -1;
                                                                                                                                                    }
                                                                                                                                                    default: {
                                                                                                                                                        // 0x8048839
                                                                                                                                                        v4 = v3 + v1;
                                                                                                                                                        if (nbyte == v3) {
                                                                                                                                                            v5 = v4;
                                                                                                                                                            // break (via goto) -> 0x804884b
                                                                                                                                                            goto lab_0x804884b_25;
                                                                                                                                                        }
                                                                                                                                                        nbyte -= v3;
                                                                                                                                                        v1 = v4;
                                                                                                                                                        // continue (via goto) -> 0x80487f4
                                                                                                                                                        goto lab_0x80487f4_25;
                                                                                                                                                        break;
                                                                                                                                                    }
                                                                                                                                                    case 0: {
                                                                                                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                                                                                    }
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                                                                            break;
                                                                                                                                        }
                                                                                                                                        case -1: {
                                                                                                                                            // 0x804881d
                                                                                                                                            err(120, "Write error!");
                                                                                                                                            // branch -> 0x8048839
                                                                                                                                            v3 = -1;
                                                                                                                                        }
                                                                                                                                        default: {
                                                                                                                                            // 0x8048839
                                                                                                                                            v4 = v3 + v1;
                                                                                                                                            if (nbyte == v3) {
                                                                                                                                                v5 = v4;
                                                                                                                                                // break (via goto) -> 0x804884b
                                                                                                                                                goto lab_0x804884b_25;
                                                                                                                                            }
                                                                                                                                            nbyte -= v3;
                                                                                                                                            v1 = v4;
                                                                                                                                            // continue (via goto) -> 0x80487f4
                                                                                                                                            goto lab_0x80487f4_25;
                                                                                                                                            break;
                                                                                                                                        }
                                                                                                                                        case 0: {
                                                                                                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                }
                                                                                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                                                                break;
                                                                                                                            }
                                                                                                                            case -1: {
                                                                                                                                // 0x804881d
                                                                                                                                err(120, "Write error!");
                                                                                                                                // branch -> 0x8048839
                                                                                                                                v3 = -1;
                                                                                                                            }
                                                                                                                            default: {
                                                                                                                                // 0x8048839
                                                                                                                                v4 = v3 + v1;
                                                                                                                                if (nbyte == v3) {
                                                                                                                                    v5 = v4;
                                                                                                                                    // break (via goto) -> 0x804884b
                                                                                                                                    goto lab_0x804884b_25;
                                                                                                                                }
                                                                                                                                nbyte -= v3;
                                                                                                                                v1 = v4;
                                                                                                                                // continue (via goto) -> 0x80487f4
                                                                                                                                goto lab_0x80487f4_25;
                                                                                                                                break;
                                                                                                                            }
                                                                                                                            case 0: {
                                                                                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                                                            }
                                                                                                                        }
                                                                                                                    }
                                                                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                                                    break;
                                                                                                                }
                                                                                                                case -1: {
                                                                                                                    // 0x804881d
                                                                                                                    err(120, "Write error!");
                                                                                                                    // branch -> 0x8048839
                                                                                                                    v3 = -1;
                                                                                                                }
                                                                                                                default: {
                                                                                                                    // 0x8048839
                                                                                                                    v4 = v3 + v1;
                                                                                                                    if (nbyte == v3) {
                                                                                                                        v5 = v4;
                                                                                                                        // break (via goto) -> 0x804884b
                                                                                                                        goto lab_0x804884b_25;
                                                                                                                    }
                                                                                                                    nbyte -= v3;
                                                                                                                    v1 = v4;
                                                                                                                    // continue (via goto) -> 0x80487f4
                                                                                                                    goto lab_0x80487f4_25;
                                                                                                                    break;
                                                                                                                }
                                                                                                                case 0: {
                                                                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                                                }
                                                                                                            }
                                                                                                        }
                                                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                                        break;
                                                                                                    }
                                                                                                    case -1: {
                                                                                                        // 0x804881d
                                                                                                        err(120, "Write error!");
                                                                                                        // branch -> 0x8048839
                                                                                                        v3 = -1;
                                                                                                    }
                                                                                                    default: {
                                                                                                        // 0x8048839
                                                                                                        v4 = v3 + v1;
                                                                                                        if (nbyte == v3) {
                                                                                                            v5 = v4;
                                                                                                            // break (via goto) -> 0x804884b
                                                                                                            goto lab_0x804884b_25;
                                                                                                        }
                                                                                                        nbyte -= v3;
                                                                                                        v1 = v4;
                                                                                                        // continue (via goto) -> 0x80487f4
                                                                                                        goto lab_0x80487f4_25;
                                                                                                        break;
                                                                                                    }
                                                                                                    case 0: {
                                                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                                    }
                                                                                                }
                                                                                            }
                                                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                            break;
                                                                                        }
                                                                                        case -1: {
                                                                                            // 0x804881d
                                                                                            err(120, "Write error!");
                                                                                            // branch -> 0x8048839
                                                                                            v3 = -1;
                                                                                        }
                                                                                        default: {
                                                                                            // 0x8048839
                                                                                            v4 = v3 + v1;
                                                                                            if (nbyte == v3) {
                                                                                                v5 = v4;
                                                                                                // break (via goto) -> 0x804884b
                                                                                                goto lab_0x804884b_25;
                                                                                            }
                                                                                            nbyte -= v3;
                                                                                            v1 = v4;
                                                                                            // continue (via goto) -> 0x80487f4
                                                                                            goto lab_0x80487f4_25;
                                                                                            break;
                                                                                        }
                                                                                        case 0: {
                                                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                        }
                                                                                    }
                                                                                }
                                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                break;
                                                                            }
                                                                            case -1: {
                                                                                // 0x804881d
                                                                                err(120, "Write error!");
                                                                                // branch -> 0x8048839
                                                                                v3 = -1;
                                                                            }
                                                                            default: {
                                                                                // 0x8048839
                                                                                v4 = v3 + v1;
                                                                                if (nbyte == v3) {
                                                                                    v5 = v4;
                                                                                    // break (via goto) -> 0x804884b
                                                                                    goto lab_0x804884b_25;
                                                                                }
                                                                                nbyte -= v3;
                                                                                v1 = v4;
                                                                                // continue (via goto) -> 0x80487f4
                                                                                goto lab_0x80487f4_25;
                                                                                break;
                                                                            }
                                                                            case 0: {
                                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                                            }
                                                                        }
                                                                    }
                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                    break;
                                                                }
                                                                case -1: {
                                                                    // 0x804881d
                                                                    err(120, "Write error!");
                                                                    // branch -> 0x8048839
                                                                    v3 = -1;
                                                                }
                                                                default: {
                                                                    // 0x8048839
                                                                    v4 = v3 + v1;
                                                                    if (nbyte == v3) {
                                                                        v5 = v4;
                                                                        // break (via goto) -> 0x804884b
                                                                        goto lab_0x804884b_25;
                                                                    }
                                                                    nbyte -= v3;
                                                                    v1 = v4;
                                                                    // continue (via goto) -> 0x80487f4
                                                                    goto lab_0x80487f4_25;
                                                                    break;
                                                                }
                                                                case 0: {
                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                }
                                                            }
                                                        }
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                        break;
                                                    }
                                                    case -1: {
                                                        // 0x804881d
                                                        err(120, "Write error!");
                                                        // branch -> 0x8048839
                                                        v3 = -1;
                                                    }
                                                    default: {
                                                        // 0x8048839
                                                        v4 = v3 + v1;
                                                        if (nbyte == v3) {
                                                            v5 = v4;
                                                            // break (via goto) -> 0x804884b
                                                            goto lab_0x804884b_25;
                                                        }
                                                        nbyte -= v3;
                                                        v1 = v4;
                                                        // continue (via goto) -> 0x80487f4
                                                        goto lab_0x80487f4_25;
                                                        break;
                                                    }
                                                    case 0: {
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                    }
                                                }
                                            }
                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                            break;
                                        }
                                        case -1: {
                                            // 0x804881d
                                            err(120, "Write error!");
                                            // branch -> 0x8048839
                                            v3 = -1;
                                        }
                                        default: {
                                            // 0x8048839
                                            v4 = v3 + v1;
                                            if (nbyte == v3) {
                                                v5 = v4;
                                                // break (via goto) -> 0x804884b
                                                goto lab_0x804884b_25;
                                            }
                                            nbyte -= v3;
                                            v1 = v4;
                                            // continue (via goto) -> 0x80487f4
                                            goto lab_0x80487f4_25;
                                            break;
                                        }
                                        case 0: {
                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                        }
                                    }
                                }
                                // Detected a possible infinite recursion (goto support failed); quitting...
                                break;
                            }
                            case -1: {
                                // 0x804881d
                                err(120, "Write error!");
                                // branch -> 0x8048839
                                v3 = -1;
                            }
                            default: {
                                // 0x8048839
                                v4 = v3 + v1;
                                if (nbyte == v3) {
                                    v5 = v4;
                                    // break (via goto) -> 0x804884b
                                    goto lab_0x804884b_25;
                                }
                                nbyte -= v3;
                                v1 = v4;
                                // continue (via goto) -> 0x80487f4
                                goto lab_0x80487f4_25;
                                break;
                            }
                            case 0: {
                                // Detected a possible infinite recursion (goto support failed); quitting...
                            }
                        }
                    }
                    // Detected a possible infinite recursion (goto support failed); quitting...
                    break;
                }
                case -1: {
                    // 0x804881d
                    err(120, "Write error!");
                    // branch -> 0x8048839
                    v3 = -1;
                }
                default: {
                    // 0x8048839
                    v4 = v3 + v1;
                    if (nbyte == v3) {
                        v5 = v4;
                        // break (via goto) -> 0x804884b
                        goto lab_0x804884b_25;
                    }
                    nbyte -= v3;
                    v1 = v4;
                    // continue (via goto) -> 0x80487f4
                    goto lab_0x80487f4_25;
                    break;
                }
                case 0: {
                    // Detected a possible infinite recursion (goto support failed); quitting...
                }
            }
        }
        // Detected a possible infinite recursion (goto support failed); quitting...
    }
}

// Address range: 0x8048857 - 0x804888b
int32_t out(int32_t a1, int32_t a2) {
    int32_t result = partial_write(a1, a2); // 0x804886a
    if (result != a2) {
        // 0x8048876
        errx(120, "Couldn't write all the data!");
        // branch -> 0x804888a
    }
    // 0x804888a
    return result;
}

// Address range: 0x804888c - 0x80488ad
int32_t string_out(char * str) {
    // 0x804888c
    return out((int32_t)str, strlen(str));
}

// Address range: 0x80488ae - 0x8048920
int32_t service_example(void) {
    puts("Hi! Welcome to our note storage service");
    puts("Want to (R)ead or (W)rite a note?");
    fflush(g2);
    int32_t str;
    fgets((char *)&str, 3, g1);
    int32_t result; // 0x8048920_2
    int32_t v1; // 0x80488f5_0
    switch ((char)v1) {
        default: {
            // 0x8048913
            result = string_out("What was that??? I don't know what that means!\n");
            // branch -> 0x804891f
            break;
        }
        case 82: {
            // 0x80488fd
            result = read_note();
            // branch -> 0x804891f
            break;
        }
        case 87: {
            // 0x804890c
            result = write_note();
            // branch -> 0x804891f
            break;
        }
    }
    // 0x804891f
    return result;
}

// Address range: 0x8048921 - 0x8048a20
int32_t read_note(void) {
    puts("Please send: note_id password");
    fflush(g2);
    int32_t putchar_rc; // 0x8048a20_2
    int32_t v1;
    int32_t str2;
    if (scanf("%u %200s", &v1, &str2) != 2) {
        // 0x8048965
        putchar_rc = string_out("Can't parse yo stuff!\n");
        // branch -> 0x8048a1f
        // 0x8048a1f
        return putchar_rc;
    }
    // 0x8048976
    int32_t str;
    sprintf((char *)&str, "%u_password", v1);
    read_file((struct _IO_FILE *)&str);
    if (strcmp((char *)&str2, (char *)&str) == 0) {
        // 0x80489cb
        sprintf((char *)&str, "%u", v1);
        read_file((struct _IO_FILE *)&str);
        printf("Note content: ");
        printf((char *)&str);
        putchar_rc = putchar(10);
        // branch -> 0x8048a1f
    } else {
        // 0x80489bd
        putchar_rc = string_out("Errr, Wrong password!\n");
        // branch -> 0x8048a1f
    }
    // 0x8048a1f
    return putchar_rc;
}

// Address range: 0x8048a21 - 0x8048afa
int32_t write_note(void) {
    puts("Please send: note_id password content");
    puts("The note_id is an number. No extra whitespace !!");
    fflush(g2);
    int32_t v1;
    int32_t v2;
    int32_t v3;
    int32_t result;
    if (scanf("%u %50s %50s", &v2, &v3, &v1) == 3) {
        // 0x8048a86
        int32_t str;
        sprintf((char *)&str, "%u", v2);
        new_file((struct _IO_FILE *)&str, (int32_t)&v1);
        sprintf((char *)&str, "%u_password", v2);
        new_file((struct n *)&str, (int32_t)&v3);
        
		result = string_out("Your note is (hopefully) safe with us! Bye!\n");
        // branch -> 0x8048af9
    } else {
        // 0x8048a78
        result = string_out("Can't parse this!\n");
        // branch -> 0x8048af9
    }
    // 0x8048af9
    return result;
}

// Address range: 0x8048afb - 0x8048b81
int32_t new_file(struct _IO_FILE * file_path, int32_t str) {
    struct _IO_FILE * file = fopen((char *)file_path, "wx"); // 0x8048b0f
    if (file == NULL) {
        // 0x8048b1d
        err(1, "new_file fopen");
        // branch -> 0x8048b31
    }
    // 0x8048b31
    if (fputs((char *)str, file) == -1) {
        // 0x8048b48
        err(1, "new_file fputs");
        // branch -> 0x8048b5c
    }
    int32_t result = fclose(file); // 0x8048b62
    if (result == -1) {
        // 0x8048b6c
        err(1, "new_file fclose");
        // branch -> 0x8048b80
    }
    // 0x8048b80
    return result;
}

// Address range: 0x8048b82 - 0x8048c23
int32_t read_file(struct _IO_FILE * file_path) {
    struct _IO_FILE * file = fopen((char *)file_path, "r"); // 0x8048b99
    if (file == NULL) {
        // 0x8048ba7
        err(1, "read_file fopen");
        // branch -> 0x8048bbb
    }
    // 0x8048bbb
    int32_t str;
    if (fgets((char *)&str, 254, file) == NULL) {
        // 0x8048bdc
        err(1, "read_file fgets");
        // branch -> 0x8048bf0
    }
    // 0x8048bf0
    if (fclose(file) == -1) {
        // 0x8048c00
        err(1, "read_file fclose");
        // branch -> 0x8048c14
    }
    // 0x8048c14
    return (int32_t)strdup((char *)&str);
}

// Address range: 0x8048c24 - 0x8048c4f
int main(int argc, char ** argv) {
    // 0x8048c24
    chdir("../append/");
    service_example();
    return 0;
}

// --------------- Dynamically Linked Functions ---------------

// void __assert_fail(const char * assertion, const char * file, unsigned int line, const char * function);
// int chdir(const char * path);
// void err(int status, const char * format, ...);
// void errx(int status, const char * format, ...);
// int fclose(FILE * stream);
// int fflush(FILE * stream);
// char * fgets(char * restrict s, int n, FILE * restrict stream);
// FILE * fopen(const char * restrict filename, const char * restrict modes);
// int fputs(const char * restrict s, FILE * restrict stream);
// int printf(const char * restrict format, ...);
// int putchar(int c);
// int puts(const char * s);
// int scanf(const char * restrict format, ...);
// int sprintf(char * restrict s, const char * restrict format, ...);
// int strcmp(const char * s1, const char * s2);
// char * strdup(const char * s);
// size_t strlen(const char * s);
// ssize_t write(int fd, const void * buf, size_t n);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (4.8.4)
// Detected functions: 9
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-05-02 02:07:59
